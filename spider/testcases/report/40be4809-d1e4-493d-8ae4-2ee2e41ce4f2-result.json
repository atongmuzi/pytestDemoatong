{"name": "test_novel_parse", "status": "broken", "statusDetails": {"message": "IndexError: list index out of range", "trace": "self = <spider.testcases.test_02_spider.TestMovieSpider object at 0x104e15c50>\n\n    def test_novel_parse(self):\n        url = 'http://www.jjwxc.net/onebook.php?novelid=6102782'\n>       lunyu_charper(url)\n\ntest_02_spider.py:18: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nurl = 'http://www.jjwxc.net/onebook.php?novelid=6102782'\n\n    def lunyu_charper(url):\n        headers = {\n            # 将拷贝的cookie值放在此处\n            'Cookie': 'timeOffset_o=-970; UM_distinctid=17d376a513e585-01e4ac2b97fb1-1c356857-13c680-17d376a513f839; '\n                      '__yjs_duid=1_d369477570198cdf74cdd58277a0019f1641891127068; testcookie=yes; '\n                      'smidV2=20210217180315da8efc623d075e08eb794e764ab5053200c2213c6a6c33400; '\n                      'CNZZDATA30075907=cnzz_eid%3D1532331810-1634022289-https%253A%252F%252Fwww.baidu.com%252F'\n                      '%26ntime%3D1649927481; Hm_lvt_bc3b748c21fe5cf393d26c12b2c38d99=1652430131; '\n                      'timeOffset_o=-230.10009765625; '\n                      'token=Mzc3MTk0MzV8N2MzNzE4ZTYyZGYyNGJjYzhiY2Q3Yjk0ZDgyZjAxNDB8fHx8MjU5MjAwMHwxfHx85pmL5rGf55So5oi3fDF8bW9iaWxlfDE%3D; JJSESS=%7B%22clicktype%22%3A%22%22%2C%22sidkey%22%3A%22GnQKXrUmzwqDe0jsVEyF4TOaciMhdt5o12%22%2C%22returnUrl%22%3A%22http%3A//www.jjwxc.net/onebook.php%3Fnovelid%3D6217458%22%7D; JJEVER=%7B%22nicknameAndsign%22%3A%222%257E%2529%2524%25E9%2598%25BF%25E7%25AB%25A5%22%2C%22foreverreader%22%3A%2237719435%22%2C%22desid%22%3A%229QSv5CRuLAbTRyzOIs/mgOoL3w4R3Xey%22%2C%22sms_total%22%3A%220%22%2C%22lastCheckLoginTimePc%22%3A1652441036%2C%22fenzhan%22%3A%22yq%22%7D; Hm_lpvt_bc3b748c21fe5cf393d26c12b2c38d99=1652687969',\n            # 注意，useragent不能改变，否则cookie失效\n            'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_2) AppleWebKit/537.36 (KHTML, like Gecko) '\n                          'Chrome/97.0.4692.71 Safari/537.36 '\n        }\n        html = spider.get_request_html(url, 'gb18030', headers)\n        spider.save_html(\"novel.html\", html, 'w')\n        # 创建解析对象\n        parse_html = etree.HTML(html)\n        # 书写xpath表达式,提取文本最终使用text()\n        # xpath_bds = '//div/div[4]/ul/li/a/text()|//div[4]/ul/li/a/@href'\n        xpath_bds_name = '//*[@id=\"oneboolt\"]/tbody/tr/td/span/div/a/text()'\n        xpath_bds_link = '//*[@id=\"oneboolt\"]/tbody/tr/td/span/div/a/@href'\n        # 提取文本数据，以列表形式输出\n        r_List_name = parse_html.xpath(xpath_bds_name)\n        r_list_link = parse_html.xpath(xpath_bds_link)\n        # 打印数据列表\n        for i in range(len(r_List_name)):\n            html_content = spider.get_request_html(r_list_link[i], 'gb18030', headers)\n            spider.save_html(\"novel_new.html\", html_content, 'w')\n            # 标题存入txt\n            spider.save_html(\"novel.txt\", r_List_name[i], 'a')\n            # 匹配文本的第一行内容\n            re_list_first = spider.patton_result(\n                r'<div style=\"clear:both;\"></div>(.*?)<br><br>', html_content)\n            # 第一行存入txt\n            spider.save_html(\"novel.txt\", re_list_first[0], 'a')\n            # 匹配文本的2到n-1行内容\n            re_list = spider.patton_result(\n                r'<br><br>(.*?)<br><br>', html_content)\n            for r in re_list:\n                spider.save_html(\"novel.txt\", r, 'a')\n            # 匹配文本的最后一行内容\n            re_list_last = spider.patton_result(\n                r'{}<br><br>(.*?)<div id=\"favoriteshow_3\"'.format(re_list[len(re_list)-1]), html_content)\n            # 最后一行存入txt\n>           spider.save_html(\"novel.txt\", re_list_last[0], 'a')\nE           IndexError: list index out of range\n\nnovel/novel.py:50: IndexError"}, "start": 1652778034279, "stop": 1652778034563, "uuid": "b4df088b-d5bb-4b13-ae42-b4ded64ceb1f", "historyId": "efd1664e3c77b16adb4a58ead7f2d553", "testCaseId": "b581ea30cbc13fe952f793629a955889", "fullName": "spider.testcases.test_02_spider.TestMovieSpider#test_novel_parse", "labels": [{"name": "parentSuite", "value": "spider.testcases"}, {"name": "suite", "value": "test_02_spider"}, {"name": "subSuite", "value": "TestMovieSpider"}, {"name": "host", "value": "tongchunyan.local"}, {"name": "thread", "value": "95308-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "spider.testcases.test_02_spider"}]}